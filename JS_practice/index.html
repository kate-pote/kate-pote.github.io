<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JS</title>
</head>
<body>
    <form name="myForm" onsubmit="myFormOnSubmit();return false">
        <input type="text" name="todo">
        <input type="submit" value="Add todo">
    </form>
    <ul id="todoList">
    </ul>
    <p>You have <span id="lScounter">0</span> todos.</p>

    <script>
    'use strict';

    let selectForm = document.forms.myForm;
    let getInput = selectForm.elements.todo;
    let todoList = document.getElementById('todoList');
    let lScounter = document.getElementById('lScounter');

    let toDoListArray = JSON.parse(localStorage.getItem("toDoListArray") || "[]");

    let countToDoS = () => lScounter.innerHTML = toDoListArray.length;
    let arrayStringify =  () => localStorage.setItem("toDoListArray", JSON.stringify(toDoListArray));


    const liEvent = function (item){
        let todoListItem = document.createElement('li');
        let todoListItemDelete = document.createElement('input');

        todoListItem.append(item.text);
        todoListItemDelete.setAttribute('type', 'button');
        todoListItemDelete.setAttribute('value', 'Delete');
        todoListItem.setAttribute('id', item.id);
        todoListItem.append(todoListItemDelete);
        todoList.append(todoListItem);
        countToDoS();

        todoListItemDelete.onclick = function () {
            todoListItem.remove();
            toDoListArray.forEach(function (i, index) {
                if (i.id === item.id){
                    toDoListArray.splice(index, 1);
                }
            });
            arrayStringify();
            countToDoS();
        };
    };

    toDoListArray.forEach((item) => liEvent(item));

    let myFormOnSubmit = function(){
        let getValueTodo = getInput.value;
        const generateRandomID = Math.random().toString(36).substr(2, 9);

        let toDoListObject = {
            text : getValueTodo,
            id : generateRandomID
        };

        toDoListArray.push(toDoListObject);
        arrayStringify();
        liEvent(toDoListObject);
    };
    </script>
</body>
</html>